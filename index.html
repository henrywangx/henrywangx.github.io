<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'å¤åˆ¶',
      copy_success: 'å¤åˆ¶æˆåŠŸ',
      copy_failure: 'å¤åˆ¶å¤±è´¥'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="æŠ€æœ¯æ—¥æ–°æœˆå¼‚ï¼Œç¢ç‰‡åŒ–çš„å­¦ä¹ æ€»ä¸å¾—å®‰å¿ƒï¼Œå› æ­¤å¼€æ­¤blogå®šæœŸè®°å½•å’Œæ€»ç»“æ‰€æ€å’Œæ‰€å¾—">
<meta property="og:type" content="website">
<meta property="og:title" content="å¤§é›„çš„éƒ¨è½é˜">
<meta property="og:url" content="&#x2F;">
<meta property="og:site_name" content="å¤§é›„çš„éƒ¨è½é˜">
<meta property="og:description" content="æŠ€æœ¯æ—¥æ–°æœˆå¼‚ï¼Œç¢ç‰‡åŒ–çš„å­¦ä¹ æ€»ä¸å¾—å®‰å¿ƒï¼Œå› æ­¤å¼€æ­¤blogå®šæœŸè®°å½•å’Œæ€»ç»“æ‰€æ€å’Œæ‰€å¾—">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>å¤§é›„çš„éƒ¨è½é˜</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">å¤§é›„çš„éƒ¨è½é˜</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>å½’æ¡£</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/henrywangx" class="github-corner" title="ç†Šå¤§ï¼šFollow me" aria-label="ç†Šå¤§ï¼šFollow me" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="/2020/01/01/kubebuilder-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="é›„å“¥good">
      <meta itemprop="description" content="æŠ€æœ¯æ—¥æ–°æœˆå¼‚ï¼Œç¢ç‰‡åŒ–çš„å­¦ä¹ æ€»ä¸å¾—å®‰å¿ƒï¼Œå› æ­¤å¼€æ­¤blogå®šæœŸè®°å½•å’Œæ€»ç»“æ‰€æ€å’Œæ‰€å¾—">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å¤§é›„çš„éƒ¨è½é˜">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/01/kubebuilder-2/" class="post-title-link" itemprop="url">kubebuilder-2:åŸç†</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-01-01 23:55:51" itemprop="dateCreated datePublished" datetime="2020-01-01T23:55:51+08:00">2020-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-01-03 00:06:20" itemprop="dateModified" datetime="2020-01-03T00:06:20+08:00">2020-01-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cloud/" itemprop="url" rel="index">
                    <span itemprop="name">Cloud</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p><strong>å¯¼è¯»</strong>ï¼šä¸Šä¸€ç¯‡blogä¸»è¦æ˜¯ç®€å•ä»‹ç»äº†ä¸€ä¸‹kubebuilderçš„ä½¿ç”¨ï¼Œè¿™é‡Œå†åˆ†æä¸€ä¸‹kubebuilderçš„ä»£ç é€»è¾‘ã€‚</p>
</blockquote>
<h2 id="1-kubebuilderçš„åŸºç¡€ï¼šcontroller"><a href="#1-kubebuilderçš„åŸºç¡€ï¼šcontroller" class="headerlink" title="1.kubebuilderçš„åŸºç¡€ï¼šcontroller"></a>1.kubebuilderçš„åŸºç¡€ï¼šcontroller</h2><p>é¦–å…ˆä»‹ç»ä¸€ä¸‹k8sçš„ä¸€ä¸ªcontrollerçš„é€»è¾‘ï¼Œä¸‹å›¾ä¸»è¦å‚è€ƒclient-goç»™çš„ä¸€ä¸ª<a href="https://github.com/kubernetes/client-go/blob/master/examples/workqueue/main.go">workQueueçš„ä¾‹å­</a>ï¼š<br><img src="/2020/01/01/kubebuilder-2/controller.png" alt="Controller"><br>è¿™é‡Œæˆ‘æŠŠä»£ç åˆ†ä¸ºé€šç”¨çš„<strong>Common part</strong>å’Œ<strong>Special Part</strong>ã€‚å‰è€…æ˜¯<a href="https://github.com/kubernetes/client-go">client-go</a>çš„åŸºæœ¬æµç¨‹ï¼Œè€Œåè€…éƒ¨åˆ†æ˜¯controllerè‡ªèº«é€»è¾‘éƒ¨åˆ†ã€‚å…·ä½“è¿‡ç¨‹åŒ…å«8ä¸ªæ­¥éª¤ï¼š</p>
<p>1.Reflectoré€šè¿‡<code>ListAndWatch</code>æ–¹æ³•å»ç›‘å¬æŒ‡å®šçš„Objectï¼›</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *Reflector)</span> <span class="title">Run</span><span class="params">(stopCh &lt;-<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	klog.V(<span class="number">3</span>).Infof(<span class="string">"Starting reflector %v (%s) from %s"</span>, r.expectedTypeName, r.resyncPeriod, r.name)</span><br><span class="line">	wait.Until(<span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> err := r.ListAndWatch(stopCh); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			utilruntime.HandleError(err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;, r.period, stopCh)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.Reflectorä¼šå°†æ‰€ç›‘å¬åˆ°çš„eventï¼ŒåŒ…æ‹¬å¯¹objectçš„<code>Add</code>ï¼Œ<code>Update</code>ï¼Œ<code>Delete</code>çš„æ“ä½œpushåˆ°<strong>DeltaFIFO</strong>è¿™ä¸ªqueueä¸­ï¼›</p>
<p>3.Informeré¦–å…ˆä¼šè§£æeventä¸­çš„actionå’Œobjectï¼›</p>
<p>4.Informerå°†è§£æçš„objectæ›´æ–°åˆ°local storeï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°cacheä¸­çš„æ•°æ®æ›´æ–°ï¼›</p>
<p>5.ç„¶åInformerä¼šæ‰§è¡ŒControlleråœ¨åˆå§‹åŒ–Infromeræ—¶æ³¨å†Œçš„<strong>ResourceEventHandler</strong>(è¿™äº›callbackæ˜¯å¯ä»¥è‡ªå·±ä¿®æ”¹çš„)ï¼›</p>
<p>6.ResourceEventHandlerä¸­æ³¨å†Œçš„callbackä¼šå°†å¯¹åº”å˜åŒ–çš„objectçš„keyå­˜å…¥å…¶åˆå§‹åŒ–çš„ä¸€ä¸ªworkQueueï¼›<br>7.æœ€ç»ˆcontrollerä¼šå¾ªç¯è¿›è¡Œreconcileï¼Œå°±æ˜¯ä»workQueueä¸åœåœ°pop keyï¼Œç„¶åå»local storeä¸­å–åˆ°å¯¹åº”çš„objectï¼Œç„¶åè¿›è¡Œå¤„ç†ï¼Œæœ€ç»ˆå¤šæ•°æƒ…å†µä¼šå†é€šè¿‡clientå»æ›´æ–°è¿™ä¸ªobjectã€‚</p>
<blockquote>
<p>ä¸Šé¢è¿™ä¸ªå…·ä½“è¿‡ç¨‹ï¼Œæˆ‘çœ‹ç½‘ä¸Šå¤§ä½¬ä»¬ä¹Ÿéƒ½åˆ†æè¿‡å¾ˆå¤šæ¬¡äº†ï¼Œä½†æ˜¯æ ¹æ®æˆ‘çš„ç»éªŒå‘¢ï¼Œè¿˜æ˜¯éœ€è¦å»çœ‹ä¸€éä»£ç å¿ƒé‡Œæ‰æœ‰åº•ã€‚ä»¥åå‡ºé—®é¢˜æˆ–è€…äºŒæ¬¡å¼€å‘çš„æ—¶å€™ï¼Œéƒ½æ˜¯éœ€è¦çŸ¥é“é‡è¦çš„ç»“æ„ä½“å’ŒAPIçš„ã€‚</p>
</blockquote>
<h2 id="2-kubebuilderçš„å°è£…"><a href="#2-kubebuilderçš„å°è£…" class="headerlink" title="2.kubebuilderçš„å°è£…"></a>2.kubebuilderçš„å°è£…</h2><p>æƒ³è¯´æ˜ä¸€ä¸‹kubebuilderå®é™…ä¸Šæ˜¯æä¾›äº†å¯¹client-goè¿›è¡Œå°è£…çš„libraryï¼Œæ›´åŠ ä¾¿åˆ©æˆ‘ä»¬æ¥å¼€å‘k8sçš„operatorã€‚</p>
<p>æˆ‘ä¸Šé¢æåˆ°çš„<a href="https://github.com/kubernetes/client-go/blob/master/examples/workqueue/main.go">workQueueçš„ä¾‹å­</a>å·²ç»å®ç°äº†ä¸€ä¸ªcontrollerçš„é€»è¾‘ã€‚è€Œkubebuilderè¿˜å¸®æˆ‘ä»¬åšäº†ä»¥ä¸‹çš„é¢å¤–å·¥ä½œï¼š</p>
<ol>
<li>kubebuilderå¼•å…¥äº†managerè¿™ä¸ªæ¦‚å¿µï¼Œä¸€ä¸ªmanagerå¯ä»¥ç®¡ç†å¤šä¸ªcontrollerï¼Œè€Œè¿™äº›controllerä¼šå…±äº«managerçš„clientï¼›</li>
<li>å¦‚æœmanageræŒ‚æ‰æˆ–è€…åœæ­¢äº†ï¼Œæ‰€æœ‰çš„controllerä¹Ÿä¼šéšä¹‹åœæ­¢ï¼›</li>
<li>kubebuilderä½¿ç”¨ä¸€ä¸ª<code>map[GroupVersionKind]informer</code>æ¥ç®¡ç†è¿™äº›controllerï¼Œæ‰€ä»¥æ¯ä¸ªcontrollerè¿˜æ˜¯æ‹¥æœ‰å…¶ç‹¬ç«‹çš„workQueueï¼ŒdeltaFIFOï¼Œå¹¶ä¸”kubebuilderä¹Ÿå·²ç»å¸®æˆ‘ä»¬å®ç°äº†è¿™éƒ¨åˆ†ä»£ç ï¼›</li>
<li>æˆ‘ä»¬ä¸»è¦éœ€è¦åšçš„å¼€å‘ï¼Œå°±æ˜¯å†™<code>Reconcile</code>ä¸­çš„é€»è¾‘ã€‚</li>
</ol>
<p>1.Manageré€šè¿‡<code>map[GroupVersionKind]informer</code>å¯åŠ¨æ‰€æœ‰controllerï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ip *specificInformersMap)</span> <span class="title">Start</span><span class="params">(stop &lt;-<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">...</span><br><span class="line">		<span class="keyword">for</span> _, informer := <span class="keyword">range</span> ip.informersByGVK &#123;</span><br><span class="line">			<span class="keyword">go</span> informer.Informer.Run(stop)</span><br><span class="line">		&#125;</span><br><span class="line">...</span><br><span class="line">	&lt;-stop</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.Controllerå¤„ç†eventçš„é€»è¾‘éƒ½åœ¨<a href="https://github.com/kubernetes-sigs/controller-runtime/blob/master/pkg/internal/controller/controller.go">https://github.com/kubernetes-sigs/controller-runtime/blob/master/pkg/internal/controller/controller.go</a>è¿™ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œå…¶å®å®ƒå°±æ˜¯å®ç°äº†workqueueè¿™ä¸ªä¾‹å­çš„å¤§éƒ¨åˆ†ä»£ç ï¼Œæ¨èå…ˆçœ‹æ‡‚è¿™ä¸ªä¾‹å­å†æ¥åˆ†æè¿™ä¸ªæ–‡ä»¶ã€‚</p>
<p>#3.å°ç»“<br>å†™è¿™ç¯‡blogæœ¬æ¥æƒ³è®²ä¸€ä¸‹kubebuilderçš„ä»£ç æµç¨‹çš„ï¼Œä½†æ˜¯å‘ç°è¦ç†è§£kubebuilderå¿…é¡»å…ˆç†è§£client-goï¼ŒåŸºæœ¬ä¸Šclient-goä»£ç ç†Ÿæ‚‰ä¹‹åå†æ¥åˆ†ækubebuilderå°±easyäº†â€¦æˆ‘è‡ªå·±å¤ªç¬¨äº†ï¼ŒèŠ±äº†å¾ˆå¤šæ—¶é—´å»å•ƒclient-goï¼Œå‡æœŸä½™é¢ç´§å¼ ï¼Œæ‰€ä»¥å…³äºkubebuilderè‡ªèº«çš„åˆ†æå°±æ²¡å†™å¤ªå¤šäº†ï¼Œæœ‰æ—¶é—´å†è¡¥å……å§ã€‚ç½‘ä¸Šæœ‰ä¸€ç¯‡å…³äº<a href="https://juejin.im/post/5d8acac2e51d4577f54a0fd2">kubebuilderçš„åˆ†æ</a>ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒä¸€ä¸‹å§ï¼Œä½†æ˜¯æˆ‘è§‰å¾—åšäºŒæ¬¡å¼€å‘ä¸€å®šè¦çœ‹è‡ªå·±äº²è‡ªçœ‹å’Œåˆ†æä¸€éã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="/2019/12/29/kubebuilder-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="é›„å“¥good">
      <meta itemprop="description" content="æŠ€æœ¯æ—¥æ–°æœˆå¼‚ï¼Œç¢ç‰‡åŒ–çš„å­¦ä¹ æ€»ä¸å¾—å®‰å¿ƒï¼Œå› æ­¤å¼€æ­¤blogå®šæœŸè®°å½•å’Œæ€»ç»“æ‰€æ€å’Œæ‰€å¾—">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å¤§é›„çš„éƒ¨è½é˜">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/12/29/kubebuilder-1/" class="post-title-link" itemprop="url">kubebuilder(1)-å®‰è£…å’Œä½¿ç”¨</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-29 00:28:30 / ä¿®æ”¹æ—¶é—´ï¼š00:31:48" itemprop="dateCreated datePublished" datetime="2019-12-29T00:28:30+08:00">2019-12-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cloud/" itemprop="url" rel="index">
                    <span itemprop="name">Cloud</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p><strong>å¯¼è¯»ï¼š</strong> ä½œä¸ºäº‘åŸç”Ÿçš„ä»ä¸šè€…ï¼Œå¤šå¤šå°‘å°‘ä¹Ÿä¼šå¬è¯´CRD(Custom Resource Definition)å’Œoperatorï¼Œä½†æ˜¯è¯´å®è¯å¼€å‘èµ·æ¥æŒºç¹ççš„ï¼Œè€Œä¸”å¯¹åˆå­¦è€…ä¹Ÿä¸å‹å¥½ã€‚è¿˜å¥½ç¤¾åŒºç›®å‰æœ‰å¥½ä½¿çš„è„šæ‰‹æ¶ï¼š<a href="https://github.com/kubernetes-sigs/kubebuilder">kubebuilder</a>å’Œ<a href="https://github.com/operator-framework/operator-sdk">operator-sdk</a>ï¼Œç›®å‰ä¸ªäººæ„Ÿè§‰å¤§å®¶ä¼šå¾€å‰è€…ç«™é˜Ÿï¼Œæ¯•ç«Ÿk8sè‡ªå®¶çš„ï¼Œç´¢æ€§å°±å­¦ç€ç”¨å®ƒæ¥å°è¯•å¼€å‘operatoräº†ã€‚è€ƒè™‘åˆ°ç¯‡å¹…å’Œè§‚æ„Ÿé—®é¢˜ï¼Œè¿™é‡Œå°±åªä»‹ç»æœ€åŸºæœ¬çš„ä½¿ç”¨ï¼Œåƒ<strong>finalizer</strong>å’Œ<strong>webhook</strong>å»ºè®®ç›´æ¥æŸ¥å®˜æ–¹æ–‡æ¡£ï¼Œcodeé€»è¾‘å¦å¤–å†™ä¸€ç¯‡å¿ƒå¾—ã€‚</p>
</blockquote>
<h2 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1.å®‰è£…"></a>1.å®‰è£…</h2><p>å®‰è£…å‚è€ƒ<a href="https://book.kubebuilder.io/quick-start.html">å®˜æ–¹æŒ‡å—</a>ï¼Œ ç”±äºgithubä¸‹è½½å¤ªæ…¢æˆ‘å°±ç”¨ç äº‘forkäº†æºæ–‡ä»¶æ¥å®‰è£…çš„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://gitee.com/henrywangx/kubebuilder.git</span><br><span class="line"><span class="built_in">cd</span> kubebuilder</span><br><span class="line">make build</span><br><span class="line">cp bin/kubebuilder <span class="variable">$GOPATH</span>/bin</span><br></pre></td></tr></table></figure>
<h2 id="2-ä½¿ç”¨"><a href="#2-ä½¿ç”¨" class="headerlink" title="2.ä½¿ç”¨"></a>2.ä½¿ç”¨</h2><p>kubebuilderä¾èµ–go moduleæ‰€ä»¥è¦æ‰“å¼€go moduleç¯å¢ƒå˜é‡:<code>export GO111MODULE=on</code>, å¦å¤–proxyæˆ–è€…å¢™çš„åŸå› ï¼Œå…ˆè®¾ä¸€ä¸‹go modçš„proxyï¼š<code>export GOPROXY=https://goproxy.io</code>, ç„¶åå°±å¯ä»¥å¼€å§‹ä½¿ç”¨äº†ã€‚æ€»ç»“å°±æ˜¯è¦ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GO111MODULE=on</span><br><span class="line"><span class="built_in">export</span> GOPROXY=https://goproxy.io</span><br></pre></td></tr></table></figure>

<h3 id="2-1åˆ›å»ºproject"><a href="#2-1åˆ›å»ºproject" class="headerlink" title="2.1åˆ›å»ºproject"></a>2.1åˆ›å»ºproject</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="variable">$GOPATH</span>/src/demo</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/demo</span><br><span class="line">kubebuilder init --domain demo.com --license apache2 --owner <span class="string">"xiong"</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åå‘¢checkä¸€ä¸‹å½“å‰æ–‡ä»¶å¤¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">tree .</span><br><span class="line">.</span><br><span class="line">â”œâ”€â”€ Dockerfile</span><br><span class="line">â”œâ”€â”€ Makefile</span><br><span class="line">â”œâ”€â”€ PROJECT</span><br><span class="line">â”œâ”€â”€ bin</span><br><span class="line">â”‚Â Â  â””â”€â”€ manager</span><br><span class="line">â”œâ”€â”€ config</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ certmanager</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ certificate.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ kustomization.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ kustomizeconfig.yaml</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ default</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ kustomization.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ manager_auth_proxy_patch.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ manager_webhook_patch.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ webhookcainjection_patch.yaml</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ manager</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ kustomization.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ manager.yaml</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ prometheus</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ kustomization.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ monitor.yaml</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ rbac</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ auth_proxy_role.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ auth_proxy_role_binding.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ auth_proxy_service.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ kustomization.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ leader_election_role.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ leader_election_role_binding.yaml</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ role_binding.yaml</span><br><span class="line">â”‚Â Â  â””â”€â”€ webhook</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ kustomization.yaml</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ kustomizeconfig.yaml</span><br><span class="line">â”‚Â Â      â””â”€â”€ service.yaml</span><br><span class="line">â”œâ”€â”€ go.mod</span><br><span class="line">â”œâ”€â”€ go.sum</span><br><span class="line">â”œâ”€â”€ hack</span><br><span class="line">â”‚Â Â  â””â”€â”€ boilerplate.go.txt</span><br><span class="line">â””â”€â”€ main.go</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œkubebuilderå¸®æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸‹æ¨¡æ¿æ–‡ä»¶å¤¹ï¼ŒåŒ…æ‹¬è§£å†³crdçš„rbac, cert, webhookçš„æ–‡ä»¶ã€‚æš‚æ—¶ä¸ç”¨ç®¡ä»–ä»¬ï¼Œè¿™æ—¶éœ€è¦ä¿è¯ä½ çš„ç»ˆç«¯èƒ½è®¿é—®k8sçš„æµ‹è¯•é›†ç¾¤ï¼Œç®€å•å°±æ˜¯ç”¨<code>kubectl cluster-info</code>çœ‹çœ‹æ˜¯å¦å‡ºé”™ï¼Œå¦‚æœä¸å‡ºé”™ï¼Œå°±å¯ä»¥runèµ·æ¥main.goäº†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl cluster-info</span><br><span class="line">go run main.go</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ç»ˆç«¯è¾“å‡ºçš„logï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2019-12-28T00:22:09.789+0800	INFO	controller-runtime.metrics	metrics server is starting to listen	&#123;<span class="string">"addr"</span>: <span class="string">":8080"</span>&#125;</span><br><span class="line">2019-12-28T00:22:09.789+0800	INFO	setup	starting manager</span><br><span class="line">2019-12-28T00:22:09.790+0800	INFO	controller-runtime.manager	starting metrics server	&#123;<span class="string">"path"</span>: <span class="string">"/metrics"</span>&#125;</span><br></pre></td></tr></table></figure>
<p>ä»<code>main.go</code>é‡Œé¢å¯ä»¥çœ‹å‡ºå…¶å®kubebuilderå¸®æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªç®¡ç†controllerçš„managerçš„ä»£ç ï¼Œä½†æ˜¯è¿˜æ²¡æ·»åŠ controllerï¼ˆcontrolleræ˜¯æŒ‡ç®¡ç†crdçš„æ§åˆ¶å™¨ï¼‰ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">...</span><br><span class="line">	mgr, err := ctrl.NewManager(ctrl.GetConfigOrDie(), ctrl.Options&#123;</span><br><span class="line">		Scheme:             scheme,</span><br><span class="line">		MetricsBindAddress: metricsAddr,</span><br><span class="line">		LeaderElection:     enableLeaderElection,</span><br><span class="line">		Port:               <span class="number">9443</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">...</span><br><span class="line">	<span class="keyword">if</span> err := mgr.Start(ctrl.SetupSignalHandler()); err != <span class="literal">nil</span> &#123;</span><br><span class="line">...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ok, æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç”¨kubebuilderå¸®æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„crdï¼Œæˆ‘å°±å«è¿™ä¸ªcrdä¸º<strong>Object</strong>å§ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubebuilder create api --group infra --version v1 --kind Object</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç®€å•æ³¨æ„ä¸€ä¸‹ï¼Œ <code>group</code>ï¼Œ <code>version</code>, <code>kind</code>è¿™ä¸‰ä¸ªå±æ€§ç»„åˆèµ·æ¥æ¥æ ‡è¯†ä¸€ä¸ªk8sçš„crdã€‚å¦å¤–å°±æ˜¯<code>kind</code>è¦é¦–å­—æ¯å¤§å†™è€Œä¸”ä¸èƒ½æœ‰ç‰¹æ®Šç¬¦å·ã€‚</p>
<p>æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ä¹‹åï¼Œkubebuilderå°±å¸®æˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªæ–‡ä»¶<code>api/v1/object_types.go</code>å’Œ<code>controllers/object_controller.go</code>, å‰è€…æ˜¯è¿™ä¸ªcrdéœ€è¦å®šä¹‰å“ªäº›å±æ€§ï¼Œè€Œåè€…æ˜¯å¯¹crdçš„reconsileçš„å¤„ç†é€»è¾‘ï¼ˆä¹Ÿå°±æ˜¯å¢åˆ æ”¹crdçš„é€»è¾‘ï¼‰, æˆ‘ä»¬åé¢å†è®²è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚æœ€åå‘¢ï¼Œåœ¨main.goé‡Œé¢ï¼Œæˆ‘ä»¬å®šä¹‰çš„<strong>Object</strong>å¯¹åº”çš„controllerä¼šæ³¨å†Œåˆ°ä¹‹å‰ç”Ÿæˆçš„manageré‡Œï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function main()&#123;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// æ³¨å†ŒObjectçš„controlleråˆ°manageré‡Œ</span></span><br><span class="line">	<span class="keyword">if</span> err = (&amp;controllers.ObjectReconciler&#123;</span><br><span class="line">		Client: mgr.GetClient(),</span><br><span class="line">		Log:    ctrl.Log.WithName(<span class="string">"controllers"</span>).WithName(<span class="string">"Object"</span>),</span><br><span class="line">		Scheme: mgr.GetScheme(),</span><br><span class="line">	&#125;).SetupWithManager(mgr); err != <span class="literal">nil</span> &#123;</span><br><span class="line">...</span><br><span class="line">	&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>èªæ˜çš„ä½ ä¸€å®šèƒ½çŒœåˆ°ï¼Œæˆ‘ä»¬åå¤æ‰§è¡Œ<code>kubebuilder create api xxx</code>è¿™æ¡å‘½ä»¤å°±ä¼šå¸®æˆ‘ä»¬åˆ›å»ºå’Œæ³¨å†Œä¸åŒçš„controlleråˆ°manageré‡Œé¢ã€‚</p>
<p>å›è¿‡å¤´æˆ‘ä»¬å†çœ‹ä¸€ä¸‹<code>api/v1/object_types.go</code>ï¼Œè¿™é‡Œæˆ‘åœ¨specé‡Œé¢åŠ ä¸€ä¸ª<code>Detail</code>ï¼Œåœ¨statusé‡Œé¢åŠ ä¸€ä¸ª<code>Created</code>ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ObjectSpec defines the desired state of Object</span></span><br><span class="line"><span class="keyword">type</span> ObjectSpec <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// INSERT ADDITIONAL SPEC FIELDS - desired state of cluster</span></span><br><span class="line">	<span class="comment">// Important: Run "make" to regenerate code after modifying this file</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Foo is an example field of Object. Edit Object_types.go to remove/update</span></span><br><span class="line">	Foo <span class="keyword">string</span> <span class="string">`json:"foo,omitempty"`</span></span><br><span class="line">	Detail <span class="keyword">string</span> <span class="string">`json:"detail,omitempty"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ObjectStatus defines the observed state of Object</span></span><br><span class="line"><span class="keyword">type</span> ObjectStatus <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// INSERT ADDITIONAL STATUS FIELD - define observed state of cluster</span></span><br><span class="line">	<span class="comment">// Important: Run "make" to regenerate code after modifying this file</span></span><br><span class="line">	Created <span class="keyword">bool</span> <span class="string">`json:"created,omitempy"`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸Škubebuilderå°±æ˜¯å¸®æˆ‘ä»¬ç”ŸæˆObjectçš„specå’Œstatusçš„æ¨¡æ¿ï¼Œä»æ³¨é‡Šå°±ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥specæ˜¯æˆ‘ä»¬æœŸæœ›çš„crdçŠ¶æ€ï¼Œè€Œstatuså°±æ˜¯è§‚æµ‹åˆ°çš„çŠ¶æ€ï¼Œå…·ä½“ä¹Ÿå¯ä»¥å‚è§k8så¯¹ä¸€ä¸ª<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/">å¯¹è±¡çš„å®šä¹‰</a>ã€‚å¯ä»¥çœ‹åˆ°é»˜è®¤å®šä¹‰ä¸‹é¢ï¼Œkubebuilderä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„yamlæ–‡ä»¶åœ¨<code>config/samples/infra_v1_object.yaml</code>:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">infra.demo.com/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Object</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">object-sample</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="comment"># Add fields here</span></span><br><span class="line">  <span class="attr">foo:</span> <span class="string">bar</span></span><br><span class="line">  <span class="attr">detail:</span> <span class="string">"detail for demo"</span></span><br></pre></td></tr></table></figure>
<p>åœ¨<code>controllers/object_controller.go</code>ï¼Œä¹Ÿå°±æ˜¯kubebuilderå¸®æˆ‘ä»¬ç”Ÿæˆçš„Reconcileä»£ç é‡Œé¢ï¼Œæˆ‘æ·»åŠ äº†æ‰“å°<code>Detail</code>çš„ä¿¡æ¯ï¼Œå¹¶ä¸”æŠŠ<code>Created</code>æ”¹æˆtrue:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ­¤methodåœ¨controllers/object_controller.go</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *ObjectReconciler)</span> <span class="title">Reconcile</span><span class="params">(req ctrl.Request)</span> <span class="params">(ctrl.Result, error)</span></span> &#123;</span><br><span class="line">	ctx := context.Background()</span><br><span class="line">	_ = r.Log.WithValues(<span class="string">"object"</span>, req.NamespacedName)</span><br><span class="line">	<span class="comment">// your logic here</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1. Print Spec.Detail and Status.Created in log</span></span><br><span class="line">	obj := &amp;infrav1.Object&#123;&#125;</span><br><span class="line">	<span class="keyword">if</span> err := r.Get(ctx, req.NamespacedName, obj); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Errorf(<span class="string">"couldn't find object:%s"</span>, req.String())</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="comment">//æ‰“å°Detailå’ŒCreated</span></span><br><span class="line">		r.Log.V(<span class="number">1</span>).Info(<span class="string">"Successfully get detail"</span>, <span class="string">"Detail"</span>, obj.Spec.Detail)</span><br><span class="line">		r.Log.V(<span class="number">1</span>).Info(<span class="string">""</span>, <span class="string">"Created"</span>, obj.Status.Created)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 2. Change Created</span></span><br><span class="line">	<span class="keyword">if</span> !obj.Status.Created &#123;</span><br><span class="line">		obj.Status.Created = <span class="literal">true</span></span><br><span class="line">		r.Update(ctx, obj)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ctrl.Result&#123;&#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>ç”±äºkubebuilderè¦ç”¨åˆ°<a href="https://github.com/kubernetes-sigs/kustomize">kustomize</a>ï¼Œæ‰€ä»¥å…ˆç¡®ä¿å…ˆè£…å¥½äº†, macçš„å®‰è£…æ–¹å¼:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install kustomize</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±installç”Ÿæˆçš„crdå¹¶ä¸”è¿è¡Œä¿®æ”¹ä»£ç åçš„manager:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make install</span><br><span class="line">go run main.go</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥ç”¨<code>config/samples/infra_v1_object.yaml</code>åˆ›å»ºä¸€ä¸ªObject:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create -f config/samples/infra_v1_object.yaml</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿è¡Œmanagerçš„ç»ˆç«¯é‡Œé¢å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšæ‰æ·»åŠ çš„ä»£ç æ‰“å°å‡ºæ¥çš„log:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2019-12-28T23:39:34.963+0800	DEBUG	controllers.Object	Successfully get detail	&#123;<span class="string">"Detail"</span>: <span class="string">"detail for demo"</span>&#125;</span><br><span class="line">2019-12-28T23:39:34.963+0800	DEBUG	controllers.Object	&#123;<span class="string">"Created"</span>: <span class="literal">false</span>&#125;</span><br><span class="line">2019-12-28T23:39:35.019+0800	DEBUG	controller-runtime.controller	Successfully Reconciled	&#123;<span class="string">"controller"</span>: <span class="string">"object"</span>, <span class="string">"request"</span>: <span class="string">"default/object-sample"</span>&#125;</span><br><span class="line">2019-12-28T23:39:35.019+0800	DEBUG	controllers.Object	Successfully get detail	&#123;<span class="string">"Detail"</span>: <span class="string">"detail for demo"</span>&#125;</span><br><span class="line">2019-12-28T23:39:35.019+0800	DEBUG	controllers.Object	&#123;<span class="string">"Created"</span>: <span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>

<p>å†çœ‹çœ‹ä»k8sé‡Œé¢çœ‹åˆ°çš„è¿™ä¸ªObjectçš„çŠ¶æ€:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">kubectl get object object-sample -o yaml</span><br><span class="line">apiVersion: infra.demo.com/v1</span><br><span class="line">kind: Object</span><br><span class="line">metadata:</span><br><span class="line">  creationTimestamp: <span class="string">"2019-12-28T15:39:34Z"</span></span><br><span class="line">  generation: 2</span><br><span class="line">  name: object-sample</span><br><span class="line">  namespace: default</span><br><span class="line">  resourceVersion: <span class="string">"433782"</span></span><br><span class="line">  selfLink: /apis/infra.demo.com/v1/namespaces/default/objects/object-sample</span><br><span class="line">  uid: 3f4b368d-2988-11ea-a544-080027d6a71e</span><br><span class="line">spec:</span><br><span class="line">  detail: detail <span class="keyword">for</span> demo</span><br><span class="line">  foo: bar</span><br><span class="line">status:</span><br><span class="line">  Created: <span class="literal">true</span>   <span class="comment">#æ­¤å¤„æ˜¯æˆ‘ä»¬ä¿®æ”¹æˆtrueçš„çŠ¶æ€</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ª<code>object-sample</code>çš„<code>status.Created</code>å·²ç»è¢«ä¿®æ”¹ä¸ºtrueäº†</p>
<h2 id="3-å…¶ä»–"><a href="#3-å…¶ä»–" class="headerlink" title="3.å…¶ä»–"></a>3.å…¶ä»–</h2><p>å…³äºæ²¡æœ‰ä»‹ç»çš„crtï¼Œwebhookå’Œfinalizerï¼Œå®˜ç½‘æ‰‹å†Œæœ‰æ¯”è¾ƒè¯¦ç»†çš„ç”¨æ³•ä»‹ç»ã€‚æˆ‘å°±ç®€å•è°ˆä¸€ä¸‹æˆ‘çš„ç†è§£ï¼Œå¦‚æœæœ‰é”™è¯¯è¯·çº æ­£ï¼š</p>
<ol>
<li><strong>webhook</strong>ï¼Œå…¶å®å°±æ˜¯å½“æˆ‘ä»¬æ·»åŠ å’Œä¿®æ”¹ä¸€ä¸ª<strong>Object</strong>æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹Objectçš„åˆæ³•æ€§è¿›è¡Œåˆ¤æ–­ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡webhookçš„frameworkæ¥è¿›è¡Œåˆæ³•æ€§çš„åˆ¤å®šï¼Œæ‰€ä»¥kubebuilderå¯ä»¥ç”Ÿæˆå¯¹åº”çš„webhookä»£ç ï¼›</li>
<li><strong>crt</strong>ï¼Œç”¨äºè§£å†³webhookè®¿é—®k8sæ—¶æ‰€éœ€è¦çš„è¯ä¹¦é—®é¢˜ï¼Œå®˜ç½‘ä¹Ÿå»ºè®®ä½¿ç”¨<a href="https://github.com/jetstack/cert-manager">crt-manager</a>è§£å†³è¯ä¹¦é—®é¢˜ï¼›</li>
<li><strong>finalizer</strong>ï¼Œå°±æ˜¯åœ¨åˆ é™¤Objectæ—¶ï¼Œç”±äºè¿™ä¸ª<strong>Object</strong>å¯èƒ½åˆ›å»ºä¸€äº›å…¶ä»–çš„resourceæ¯”å¦‚podä¹‹ç±»çš„ï¼Œåˆæˆ–è€…åœ¨åˆ é™¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›æ¸…ç†å·¥ä½œï¼Œ<strong>finalizer</strong>å°±æ˜¯å®ç°è¿™ä¸ªæ¸…ç†çš„frameworkä»£ç ï¼›</li>
</ol>
<p>å¦å¤–kubebuilderä¹Ÿæ˜¯æ”¯æŒæŠŠè¿™ä¸ªmanageréƒ¨ç½²ä¸ºdeploymentï¼Œä½†æ˜¯è°ƒè¯•èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥å°±åªç”¨<code>go run</code>çš„å½¢å¼æ¼”ç¤ºäº†ã€‚</p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™ç¯‡blogç®€å•çš„ä»‹ç»äº†ä¸€ä¸‹kubebuilderå¼€å‘crdçš„åŸºæœ¬è¿‡ç¨‹ï¼Œæ²¡æœ‰æ·±å…¥è¿‡å¤šçš„ä»£ç åŸç†ï¼Œå¯èƒ½ä¹Ÿæœ‰ä¸å°‘é”™è¯¯åœ°æ–¹ï¼Œéº»çƒ¦å¸®å¿™çº æ­£ã€‚å¦å¤–å¤§å®¶å¯èƒ½è·Ÿæˆ‘åˆšå­¦ä¹ kubebuilderçš„æ—¶å€™ä¸€æ ·ï¼Œåªèƒ½ç…§ç€å®˜ç½‘æ•™ç¨‹æ•²å‘½ä»¤ï¼Œkubebuilderç”Ÿæˆçš„ä»£ç å°±åƒä¸€ä¸ªé»‘ç›’ä¸€æ ·ï¼Œæ¥ä¸‹æ¥ç›®æ ‡å°±æ˜¯ä¸“é—¨æ•´ç†ä¸€ä¸‹kubebuilderç”Ÿæˆcrdä»£ç æµç¨‹å’Œç»“æ„ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="/2019/12/16/find-job/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="é›„å“¥good">
      <meta itemprop="description" content="æŠ€æœ¯æ—¥æ–°æœˆå¼‚ï¼Œç¢ç‰‡åŒ–çš„å­¦ä¹ æ€»ä¸å¾—å®‰å¿ƒï¼Œå› æ­¤å¼€æ­¤blogå®šæœŸè®°å½•å’Œæ€»ç»“æ‰€æ€å’Œæ‰€å¾—">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å¤§é›„çš„éƒ¨è½é˜">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/12/16/find-job/" class="post-title-link" itemprop="url">ä»è£å‘˜åˆ°æ‰¾å·¥ä½œå†å…¥èŒçš„æ„Ÿæƒ³</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-16 16:37:52 / ä¿®æ”¹æ—¶é—´ï¼š17:55:44" itemprop="dateCreated datePublished" datetime="2019-12-16T16:37:52+08:00">2019-12-16</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬äººæ˜¯åœ¨ä¸€ä¸ªä¼ ç»Ÿå¤–ä¼å·¥ä½œä¸¤å¹´å¤šçš„å¼±é¸¡ï¼Œä¸€ä¸ªæœˆå‰ï¼Œæ‰€åœ¨çš„éƒ¨é—¨è¢«ä¸€é”…ç«¯æ‰äº†ï¼Œå½“ç„¶èµ”å¿ä¹Ÿæ˜¯æ¯”è¾ƒå¯è§‚ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†äººç¬¬ä¸€ååº”ä¹Ÿæ˜¯æ¯”è¾ƒæ·¡å®šçš„â€¦ä½†æ˜¯å‘¢ï¼Œæœ¬äººç”±äºä¸€æ–¹é¢åˆšä¹°æˆ¿æ¬ ç€ä¸€å±è‚¡é¦–ä»˜æ¬¾ğŸ˜¢ï¼›å¦å¤–ä¸€æ–¹é¢ï¼Œæˆ‘è§‰å¾—ä¼‘æ¯è¶…è¿‡ä¸€ä¸ªæœˆæ—¶é—´ä¼šå®¹æ˜“è®©äººæ„Ÿåˆ°ç–²æƒ«å’Œå •è½ï¼Œæ‰€ä»¥ä¸‹å†³å¿ƒè¿˜æ˜¯è¦åœ¨ä¸€ä¸ªæœˆå†…æ‰¾åˆ°å·¥ä½œã€‚ç»“å±€è¿˜æ˜¯ç¬¦åˆæˆ‘çš„è®¡åˆ’ï¼Œä¸€ä¸ªæœˆå†…é¡ºåˆ©æ‹¿åˆ°äº†å‡ å®¶å¤§å‚çš„offerï¼Œé©¬ä¸Šå…¥èŒã€‚è¿™ç¯‡blogåªæ˜¯æƒ³ç®€å•é˜è¿°ä¸€ä¸‹æ„Ÿå—ï¼Œè€Œä¸æ˜¯èµ·ä¸ªä»€ä¹ˆå™±å¤´ï¼Œä¸ç„¶æˆ‘å¤§å¯ä»¥æŠŠæ ‡é¢˜æ”¹æˆâ€“æˆ‘æ˜¯å¦‚ä½•ä¸€ä¸ªæœˆæ‹¿åˆ°xx,xx,xxçš„offerçš„ã€‚</p>
<h2 id="è£å‘˜"><a href="#è£å‘˜" class="headerlink" title="è£å‘˜"></a>è£å‘˜</h2><p>é¦–å…ˆå…³äºè£å‘˜ï¼Œæˆ‘æ­£å¥½åœ¨ä¸€å®¶ç¾ä¼ï¼Œä¸€æ–¹é¢ç”±äºä¸­ç¾è´¸æ˜“ï¼Œå¦å¤–ä¸€æ–¹é¢æ‰€å¤„çš„è¡Œä¸šè¢«äººå–»ä¸ºæ˜¯å¤•é˜³è¡Œä¸šï¼Œæ‰€ä»¥åŒäº‹é—´ä¹Ÿè€æ—©å°±æ„Ÿè§‰åˆ°ä¼šè£å‘˜äº†ã€‚åˆå› ä¸ºèµ”å¿æ¯”è¾ƒå¯è§‚ï¼Œæ‰€ä»¥å¤§å®¶éƒ½æ˜¯æ¯”è¾ƒæœŸå¾…è¿™ä»½è£å‘˜çš„ã€‚è€Œå½“è¿™ä»¶äº‹çœŸæ­£å‘ç”Ÿåˆ°å¤§å®¶èº«ä¸Šæ—¶ï¼Œå…¶å®å¾ˆå¤šäººåœ¨ç¬¬ä¸€ä¸ªæ˜ŸæœŸæ˜¯æ— æ³•å…¥çœ çš„ã€‚å…¶å®å¾ˆå¥½åˆ†æï¼Œå¤§å®¶ä¸»è¦ä¹Ÿæ˜¯2ç§å¿ƒæ€ï¼š</p>
<ol>
<li>å…¥è¡Œä¸æ·±çš„å¹´è½»äººï¼ŒåŒ…æ‹¬æˆ‘è‡ªå·±ï¼Œæ¯”è¾ƒå…´å¥‹èƒ½å¤Ÿè·å¾—ä¸€å¤§ç¬”èµ„é‡‘ã€‚ä½†æ˜¯å¦ä¸€æ–¹é¢å¿ƒé‡Œä¹Ÿæœ‰ä¸ç”˜ï¼Œç¬¬ä¸€ä»½å·¥ä½œç«Ÿç„¶æ˜¯å¦‚æ­¤è‰è‰ç»“æŸçš„ï¼›</li>
<li>ä¹ æƒ¯å…¬å¸çš„è€å¹´äººï¼Œä¸€éƒ¨åˆ†åŒäº‹å…¶å®æ˜¯å¯¹å¤§ç¤¼åŒ…æœ¬ä»¥ç¿˜é¦–ä»¥ç›¼ï¼Œè€Œå¦ä¸€éƒ¨åˆ†åŒäº‹åˆå¯¹å¤±ä¸šæˆ–è€…ä¸‹ä¸€ä¸ªè½è„šåœ°è¡¨ç¤ºç´§å¼ å’Œä¸å®‰ï¼›</li>
</ol>
<p>æ‰€ä»¥å¤§å®¶ååº”éƒ½æ˜¯å¼€å¿ƒï¼Œæ¿€åŠ¨å’Œä¸å®‰ã€‚</p>
<h2 id="æ‰¾å·¥ä½œ"><a href="#æ‰¾å·¥ä½œ" class="headerlink" title="æ‰¾å·¥ä½œ"></a>æ‰¾å·¥ä½œ</h2><p>åŒæ ·åˆ†ä¸ºå¹´è½»äººå’Œè€å¹´äººï¼š</p>
<ol>
<li>å¯¹äºå¹´è½»äººæ¯”å¦‚æˆ‘è‡ªå·±ï¼Œç”±äºæˆ‘ä»¬éƒ¨é—¨è£å‘˜å‰ä¸€ç›´åœ¨åšäº‘åŸç”Ÿæ–¹å‘çš„å¼€å‘ã€‚æ­£å¥½å¸‚é¢ä¸Šäº‘åŸç”Ÿæ˜¯ä¸€ä¸ªéå¸¸ç«çš„æ–¹å‘ï¼Œè‡ªå­¦æˆ–è€…åŸ¹è®­æ˜¯æ²¡åŠæ³•è®©ä½ æŒæ¡è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚åŒæ—¶å¹´æœ«ï¼Œå¸‚é¢ä¸Šä¹Ÿæ˜¯æ²¡æœ‰å¤šå°‘äººæ„¿æ„å‡ºæ¥è¯•æœºä¼šçš„ï¼Œæ‰€ä»¥æ€»ä½“æ¥è¯´ä¾›ä¸åº”æ±‚ã€‚</li>
<li>è€Œå¯¹äºè€å¹´äººï¼Œå¤§å®¶çš„æŠ€æœ¯æ ˆå’Œç»éªŒæ›´å¤šåœ¨è€å“æˆ–è€…è¯´éäº’è”ç½‘çš„é¢†åŸŸï¼Œç›¸å¯¹æ¥è¯´å¸‚é¢ä¸Šçš„éœ€æ±‚å¹¶æ²¡æœ‰è¿™ä¹ˆå¤§ï¼Œè€Œå¦ä¸€æ–¹é¢ç”±äºå·¥é¾„è¾ƒé•¿ï¼Œå¯¹åº”å·¥é¾„çš„å²—ä½ä¹Ÿæ˜¯ç›¸å¯¹æ¥è¯´è¾ƒå°‘ï¼Œæ‰€ä»¥å¯èƒ½çœ‹ä¸Šå»æ²¡æœ‰å¹´è½»äººé‚£ä¹ˆæŠ¢æ‰‹ã€‚</li>
</ol>
<h2 id="å¦‚ä½•é¿å…æ‰¾å·¥ä½œå›°éš¾çš„çª˜å¢ƒ"><a href="#å¦‚ä½•é¿å…æ‰¾å·¥ä½œå›°éš¾çš„çª˜å¢ƒ" class="headerlink" title="å¦‚ä½•é¿å…æ‰¾å·¥ä½œå›°éš¾çš„çª˜å¢ƒ"></a>å¦‚ä½•é¿å…æ‰¾å·¥ä½œå›°éš¾çš„çª˜å¢ƒ</h2><p>é¦–å…ˆï¼Œæˆ‘è§‰å¾—æˆ‘æ˜¯æ²¡æœ‰ä»€ä¹ˆèµ„æ ¼æ¥å›ç­”è¿™ä¸ªé—®é¢˜çš„ï¼Œç½‘ä¸Šæœ‰å„ç§å¤§ä½¬å’Œç‰›äººã€‚æˆ‘åªæ˜¯æœ‰ä¸€äº›æ€è€ƒï¼Œé¿å…è‡ªå·±ä¹Ÿä¸­å¹´å¤±ä¸šï¼Œä»æˆ‘è§‚å¯Ÿä¸­å¾—å‡ºä¸€äº›ä½“ä¼šï¼š</p>
<ol>
<li><strong>å­¦ä¼šæ€»ç»“å’Œæ€è€ƒ</strong>ã€‚å¾ˆå¤šåŒäº‹éƒ½ä¼šè¯´è‡ªå·±æœ‰æ€»ç»“æœ‰æ€è€ƒå•Šï¼Œå¯æ˜¯ä¸ºä»€ä¹ˆè¢«é¢è¯•çš„æ—¶å€™è¿˜æ˜¯ä»€ä¹ˆéƒ½è¯´ä¸æ¸…æ¥šï¼Œæ²¡æ³•å±•ç¤ºè‡ªå·±ã€‚è¿™é‡Œæˆ‘åªèƒ½è¯´ï¼Œä½ æ€è€ƒå¾—ä¸å¤Ÿå½»åº•ï¼Œä½ åªæ˜¯ç‰‡é¢çš„å¯¹é—®é¢˜æˆ–è€…è®¾è®¡ç†è§£äº†ã€‚é‚£å¦‚ä½•æ·±åˆ»ç†è§£å‘¢ï¼Ÿæˆ‘è§‰å¾—æ˜¯åˆ†äº«ï¼Œåˆ†äº«æ‰èƒ½è®©ä½ æŒæ¡90%çš„çŸ¥è¯†ã€‚ç”±äºåœ¨å·¥ä½œæœŸé—´æˆ‘ç»å¸¸éœ€è¦å†™æ–‡æ¡£ç»™äººreviewï¼Œå¦ä¸€æ–¹é¢è™½ç„¶æˆ‘å¾ˆæ‡’ï¼Œä½†æ˜¯æˆ‘ä¹Ÿå°½é‡æŠŠå¹³æ—¶é‡åˆ°çš„é—®é¢˜æ•´ç†ä¸‹æ¥ï¼Œå½¢æˆblogæˆ–è€…å…¶ä»–æ–‡æ¡£ã€‚æ¯æ¬¡å†™æ–‡æ¡£ä½ éƒ½ä¼šé—®è‡ªå·±ï¼Œè¿™æ ·åˆ«äººèƒ½çœ‹æ‡‚å—ï¼Ÿæ€ä¹ˆæ ·è¯»è€…æ˜¯èƒ½å¤Ÿæœ€å®¹æ˜“ç†è§£ä½ çš„pointï¼Ÿè¯»è€…ä¼šé—®ä»€ä¹ˆæ ·çš„é—®é¢˜å‘¢ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡å‘¢ï¼Ÿæ‰€ä»¥å†™æ–‡æ¡£ä½œåˆ†äº«çš„æ—¶å€™ä¼šè®©ä½ æŠŠä¹‹å‰æ²¡è€ƒè™‘çš„é—®é¢˜é‡æ–°æ€è€ƒå’Œçº æ­£ä¸€éã€‚æ‰¾å·¥ä½œä¹‹å‰æˆ‘æ²¡æœ‰ä½œä»»ä½•å‡†å¤‡ï¼ŒåŒ…æ‹¬åˆ·é¢˜ï¼Œä½†æ˜¯æˆ‘éƒ½é¡ºåˆ©çš„é€šè¿‡äº†é¢è¯•ã€‚ä¸€æ–¹é¢æ˜¯è¿æ°”å¥½ï¼Œäº‘åŸç”Ÿä¾›ä¸åº”æ±‚ï¼Œå¦ä¸€æ–¹é¢å°±æ˜¯å› ä¸ºæˆ‘çš„æ¯æ¬¡é¢è¯•åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨åˆ†äº«æˆ‘çš„æ–‡æ¡£æˆ–è€…ç»™äººä½œpresentationï¼Œåº”è¯¥èƒ½è®©é¢è¯•å®˜èƒ½å¤Ÿæ¯”è¾ƒè½»æ¾çš„äº†è§£ä½ åšäº†ä»€ä¹ˆè€Œä¸”æ˜¯æœ‰æ€è€ƒçš„ã€‚</li>
<li><strong>æ‰¾å‡†å®šä½</strong>ã€‚ä¸€å®šè¦æ˜ç™½è‡ªå·±çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿ï¼Œå¯¹äºæˆ‘è€Œè¨€ï¼Œæˆ‘çš„ä¼˜åŠ¿æ˜¯åœ¨æ‹¥æœ‰å¼€å‘ç»éªŒå’ŒæŠ€èƒ½çš„åŒæ—¶ç†Ÿæ‚‰äº‘åŸç”Ÿçš„ä½“ç³»å’ŒçŸ¥è¯†ï¼Œæ‰€ä»¥æˆ‘ä¸€å®šè¦åœ¨äº‘åŸç”Ÿçš„ç¯å¢ƒä¸‹æ‰¾å·¥ä½œçš„ï¼Œè€Œä¸æ˜¯ç®€å•å»åšä¸€ä¸ªä¸šåŠ¡çš„åå°å¼€å‘å·¥ç¨‹å¸ˆï¼ŒCRUDæˆ‘æ˜¯æ‹¼ä¸è¿‡åˆ«äººçš„ï¼Œä½†æ˜¯ä»–ä»¬æ˜¯æ²¡æ³•æ‹¥æœ‰äº‘åŸç”Ÿçš„å®é™…ä½¿ç”¨ç»éªŒçš„ã€‚</li>
<li><strong>çƒ­çˆ±å·¥ä½œ</strong>ã€‚å¦‚ä½•é¿å…ä¸­å¹´å¤±ä¸šå±æœºï¼Œæˆ‘è§‰å¾—é¦–å…ˆå¤§å®¶å¦‚æœè¦ç»§ç»­åœ¨è¿™ä¸ªè¡Œä¸šå¹²ï¼Œéœ€è¦ä¿æŒæ¿€æƒ…ï¼Œçƒ­çˆ±è¿™ä¸ªè¡Œä¸š(æˆ‘è§‰å¾—è¿™ä¸ªæ¯”è¾ƒéš¾)ï¼Œä½†æ˜¯æˆ‘æ˜¯é€šè¿‡çƒ­çˆ±è§£å†³é—®é¢˜ï¼Œæ¥çƒ­çˆ±è¿™ä¸ªè¡Œä¸šã€‚</li>
<li><strong>å·¥ç¨‹åŒ–èƒ½åŠ›</strong>ã€‚é¦–å…ˆæˆ‘ä»¬å…¬å¸çš„<code>è€å¹´äºº</code>æ˜¯éå¸¸ä¼˜ç§€çš„ï¼Œå°¤å…¶æ˜¯æˆ‘çš„åŒäº‹ã€‚æˆ‘çš„åŒäº‹æ˜¯ä¸€ä¸ªéå¸¸èµ„æ·±çš„engineerï¼Œæˆ‘èƒ½æ„Ÿè§‰åˆ°ä»–çš„å·¥åŒ ç²¾ç¥ï¼Œå¯¹é—®é¢˜æ€è€ƒçš„å…¨é¢å’Œä¸¥è°¨æ€§ï¼Œå·¥ç¨‹åŒ–çš„æ€æƒ³ï¼Œèƒ½æŠ“ä½ç—›ç‚¹ï¼Œè§£å†³ä¸»è¦é—®é¢˜çš„æ€è€ƒæ–¹å¼ã€‚æ‰€ä»¥æˆ‘è§‰å¾—ä»–æ˜¯éå¸¸é€‚åˆä»»ä½•è¡Œä¸šï¼Œä¹Ÿèƒ½å¤Ÿé¡ºåˆ©æ‰¾åˆ°å¥½å·¥ä½œçš„ã€‚ä»ä»–çš„èº«ä¸Šï¼Œä¹Ÿæé†’äº†æˆ‘ï¼Œä½ æ‰€æŒæ¡çš„æŠ€èƒ½å¯èƒ½ä¼šè¿‡æ—¶ï¼Œä½†æ˜¯ä¸€å®šè¦å…·å¤‡å·¥ç¨‹èƒ½åŠ›ï¼Œè§£å†³é—®é¢˜çš„èƒ½åŠ›ã€‚æ€»ä¹‹æˆ‘çš„åŒäº‹æ˜¯éå¸¸å€¼å¾—æˆ‘å­¦ä¹ çš„ï¼Œå¸Œæœ›ä»¥åä¹Ÿèƒ½è¾¾åˆ°ä»–çš„æ°´å¹³ï¼Œä»»ä½•æ—¶å€™éƒ½ä¸ç”¨ç•æƒ§å¤±ä¸šã€‚</li>
</ol>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å…¶å®å°±æ˜¯é©¬ä¸Šå‡†å¤‡è¦å…¥èŒäº†å” å—‘ä¸€ä¸‹å§ï¼Œå¦å¤–ä¹Ÿæœ‰åŒäº‹è®©æˆ‘ç»™ä»–ä»¬è®²æˆ‘æ€ä¹ˆé¢è¯•çš„ï¼Œå®åœ¨æ²¡åŠæ³•ï¼ŒåˆæŠŠæ•´ä¸ªé¡¹ç›®æ¶æ„åšçš„ä¸œè¥¿ç»™ä»–ä»¬è®²äº†ä¸€éã€‚å…¶å®æˆ‘å¸Œæœ›ä»–ä»¬è‡ªå·±èƒ½è®²å‡ºæ¥ï¼Œè€Œä¸æ˜¯æˆ‘æ¥å‘Šè¯‰ä»–ä»¬äº†ã€‚é©¬ä¸Šè¦å…¥èŒäº†ï¼Œå¸Œæœ›è‡ªå·±èƒ½å¤Ÿè¿›ä¸€æ­¥çš„æˆé•¿å§ï¼Œæˆç†Ÿä¸€ç‚¹ğŸ˜ä¹Ÿå¸Œæœ›æ‰€æœ‰äººèƒ½å¤Ÿæ‰¾åˆ°é€‚åˆè‡ªå·±çš„å²—ä½ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="/2019/11/03/first-blog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="é›„å“¥good">
      <meta itemprop="description" content="æŠ€æœ¯æ—¥æ–°æœˆå¼‚ï¼Œç¢ç‰‡åŒ–çš„å­¦ä¹ æ€»ä¸å¾—å®‰å¿ƒï¼Œå› æ­¤å¼€æ­¤blogå®šæœŸè®°å½•å’Œæ€»ç»“æ‰€æ€å’Œæ‰€å¾—">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å¤§é›„çš„éƒ¨è½é˜">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/03/first-blog/" class="post-title-link" itemprop="url">å¼€å¯ä¸ªäººblog</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-03 00:35:30 / ä¿®æ”¹æ—¶é—´ï¼š15:54:29" itemprop="dateCreated datePublished" datetime="2019-11-03T00:35:30+08:00">2019-11-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9A%8F%E7%AC%94/" itemprop="url" rel="index">
                    <span itemprop="name">éšç¬”</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æœ€è¿‘å‘ç°å„ä½å¤§ä½¬çš„blogé£æ ¼éƒ½æŒºå°æ¸…æ–°çš„ï¼Œgoogleå¾—çŸ¥æœ‰<a href="https://hexo.io">Hexo</a>è¿™ä¸ªblogç¥å™¨ï¼Œäºæ˜¯ä¹Ÿå°è¯•æ­å»ºè‡ªå·±çš„blogç”¨äºç»§ç»­è®°å½•è‡ªå·±çš„æ‰€æ€æ‰€å¾—ã€‚</p>
<p>ä¹‹å‰çš„blogéƒ½æ”¾åœ¨<a href="https://www.jianshu.com/u/4d0fe9f124a2">ç®€ä¹¦</a>ä¸Šï¼Œä»¥åè‡ªå·±çš„blogéƒ½ä¸»è¦ä¼šåœ¨æ­¤æ›´æ–°ï¼Œç®€ä¹¦ä¸Šé¢çš„blogå°½åŠ›åŒæ­¥æ›´æ–°ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="é›„å“¥good"
    src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">é›„å“¥good</p>
  <div class="site-description" itemprop="description">æŠ€æœ¯æ—¥æ–°æœˆå¼‚ï¼Œç¢ç‰‡åŒ–çš„å­¦ä¹ æ€»ä¸å¾—å®‰å¿ƒï¼Œå› æ­¤å¼€æ­¤blogå®šæœŸè®°å½•å’Œæ€»ç»“æ‰€æ€å’Œæ‰€å¾—</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/henrywangx" title="GitHub &amp;rarr; https:&#x2F;&#x2F;github.com&#x2F;henrywangx" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:henrywangx@163.com" title="E-Mail &amp;rarr; mailto:henrywangx@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.jianshu.com/u/4d0fe9f124a2" title="ç®€ä¹¦ &amp;rarr; https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;4d0fe9f124a2" rel="noopener" target="_blank"><i class="fa fa-fw fa-heartbeat"></i>ç®€ä¹¦</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">é›„å“¥good</span>
</div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  
















  

  


</body>
</html>
